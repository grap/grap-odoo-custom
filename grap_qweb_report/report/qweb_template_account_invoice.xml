<?xml version="1.0" encoding="UTF-8"?>
<!--
Copyright (C) 2018 - Today: GRAP (http://www.grap.coop)
@author: Sylvain LE GAL (https://twitter.com/legalsylvain)
License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl.html).
-->
<odoo>

    <template id="template_account_invoice" inherit_id="account.report_invoice_document">

        <!-- Add Custom Message -->
        <xpath expr="//div[hasclass('page')]/h2/.." position="before">
            <t t-raw="o.report_custom_message"/>
        </xpath>

        <!-- Changement car si la description est trop longue
             ça merdait en affichant pas les auttres champs-->
        <xpath expr="//div[@id='informations']" position="replace">
            <div id="informations">
                <div class="col-xs-10">
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th t-if="o.date_invoice">Date de facture</th>
                                <th t-if="o.date_due">Date d'échéance</th>
                                <th t-if="o.name">Description</th>
                                <th t-if="o.origin">Origine</th>
                            </tr>
                        </thead>
                        <tbody class="invoice_tbody">
                            <tr>
                                <td t-if="o.date_invoice" class="col-xs-3">
                                    <span t-field="o.date_invoice"/>
                                </td>
                                <td t-if="o.date_due" class="col-xs-3">
                                    <span t-field="o.date_due"/>
                                </td>
                                <td t-if="o.name">
                                    <span t-esc="o.name"/>
                                </td>
                                <td t-if="o.origin">
                                    <span t-esc="o.origin"/>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </xpath>

        <!-- Nom colonne : Distinguer prix unitaire HT et TTC -->
        <xpath expr="//th[@name='th_priceunit']" position="replace">
            <th t-if="o.price_unit_include_taxes" name="th_priceunit" t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}"><span>P.U&#160;(TTC)</span></th>
            <th t-else="" name="th_priceunit" t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}"><span>P.U&#160;(HT)</span></th>
        </xpath>

        <!-- Nom colonne : Distinguer sous total HT et TTC -->
        <xpath expr="//th[@name='th_subtotal']" position="replace">
            <th t-if="o.price_unit_include_taxes" name="th_subtotal" class="text-right">
                <span groups="account.group_show_line_subtotals_tax_excluded">S.T&#160;(TTC)</span>
            </th>
            <th t-else="" name="th_subtotal" class="text-right">
                <span groups="account.group_show_line_subtotals_tax_excluded">S.T&#160;(HT)</span>
            </th>
        </xpath>

        <!-- Ligne SousTotal : afficher avec HT ou TTC -->
<!--         <xpath expr="//t[@name='account_invoice_line_accountable']/td[hasclass('o_price_total')]" position="replace">
            <td class="text-right o_price_total">
                <span t-field="line.price_total_displayed"/>
            </td>
        </xpath> -->
        <!-- ESSAI sans le display-->
        <xpath expr="//t[@name='account_invoice_line_accountable']/td[hasclass('o_price_total')]" position="replace">
            <td t-if="o.price_unit_include_taxes" class="text-right">
                <span t-field="line.price_total"/>
            </td>
            <td t-else="" class="text-right">
                <span t-field="line.price_subtotal"/>
            </td>
        </xpath>


    </template>

</odoo>
